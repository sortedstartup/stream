// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.28.0
// source: queries.sql

package db

import (
	"context"
	"database/sql"
	"time"
)

const createChannel = `-- name: CreateChannel :one
INSERT INTO userservice_channels (
    id,
    tenant_id,
    name,
    description,
    is_private,
    created_by,
    created_at,
    updated_at
) VALUES (
    ?1,
    ?2,
    ?3,
    ?4,
    ?5,
    ?6,
    ?7,
    ?8
) RETURNING id, tenant_id, name, description, is_private, created_by, created_at, updated_at
`

type CreateChannelParams struct {
	ID          string
	TenantID    string
	Name        string
	Description sql.NullString
	IsPrivate   bool
	CreatedBy   string
	CreatedAt   time.Time
	UpdatedAt   time.Time
}

// Channel queries
func (q *Queries) CreateChannel(ctx context.Context, arg CreateChannelParams) (UserserviceChannel, error) {
	row := q.db.QueryRowContext(ctx, createChannel,
		arg.ID,
		arg.TenantID,
		arg.Name,
		arg.Description,
		arg.IsPrivate,
		arg.CreatedBy,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	var i UserserviceChannel
	err := row.Scan(
		&i.ID,
		&i.TenantID,
		&i.Name,
		&i.Description,
		&i.IsPrivate,
		&i.CreatedBy,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const createChannelMember = `-- name: CreateChannelMember :one
INSERT INTO userservice_channel_members (
    id,
    channel_id,
    user_id,
    role,
    added_by,
    created_at
) VALUES (
    ?1,
    ?2,
    ?3,
    ?4,
    ?5,
    ?6
) RETURNING id, channel_id, user_id, role, added_by, created_at
`

type CreateChannelMemberParams struct {
	ID        string
	ChannelID string
	UserID    string
	Role      string
	AddedBy   string
	CreatedAt time.Time
}

func (q *Queries) CreateChannelMember(ctx context.Context, arg CreateChannelMemberParams) (UserserviceChannelMember, error) {
	row := q.db.QueryRowContext(ctx, createChannelMember,
		arg.ID,
		arg.ChannelID,
		arg.UserID,
		arg.Role,
		arg.AddedBy,
		arg.CreatedAt,
	)
	var i UserserviceChannelMember
	err := row.Scan(
		&i.ID,
		&i.ChannelID,
		&i.UserID,
		&i.Role,
		&i.AddedBy,
		&i.CreatedAt,
	)
	return i, err
}

const createTenant = `-- name: CreateTenant :one
INSERT INTO userservice_tenants (
    id,
    name,
    description,
    is_personal,
    created_at,
    created_by
) VALUES (
    ?1,
    ?2,
    ?3,
    ?4,
    ?5,
    ?6
) RETURNING id, name, description, is_personal, created_at, created_by
`

type CreateTenantParams struct {
	ID          string
	Name        string
	Description sql.NullString
	IsPersonal  bool
	CreatedAt   time.Time
	CreatedBy   string
}

// Tenant queries
func (q *Queries) CreateTenant(ctx context.Context, arg CreateTenantParams) (UserserviceTenant, error) {
	row := q.db.QueryRowContext(ctx, createTenant,
		arg.ID,
		arg.Name,
		arg.Description,
		arg.IsPersonal,
		arg.CreatedAt,
		arg.CreatedBy,
	)
	var i UserserviceTenant
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.IsPersonal,
		&i.CreatedAt,
		&i.CreatedBy,
	)
	return i, err
}

const createTenantUser = `-- name: CreateTenantUser :one
INSERT INTO userservice_tenant_users (
    id,
    tenant_id,
    user_id,
    role,
    created_at
) VALUES (
    ?1,
    ?2,
    ?3,
    ?4,
    ?5
) RETURNING id, tenant_id, user_id, role, created_at
`

type CreateTenantUserParams struct {
	ID        string
	TenantID  string
	UserID    string
	Role      string
	CreatedAt time.Time
}

func (q *Queries) CreateTenantUser(ctx context.Context, arg CreateTenantUserParams) (UserserviceTenantUser, error) {
	row := q.db.QueryRowContext(ctx, createTenantUser,
		arg.ID,
		arg.TenantID,
		arg.UserID,
		arg.Role,
		arg.CreatedAt,
	)
	var i UserserviceTenantUser
	err := row.Scan(
		&i.ID,
		&i.TenantID,
		&i.UserID,
		&i.Role,
		&i.CreatedAt,
	)
	return i, err
}

const createUser = `-- name: CreateUser :one
INSERT INTO userservice_users (
    id,
    username,
    email,
    created_at
) VALUES (
    ?1,
    ?2,
    ?3,
    ?4
) RETURNING id, username, email, created_at
`

type CreateUserParams struct {
	ID        string
	Username  string
	Email     string
	CreatedAt time.Time
}

func (q *Queries) CreateUser(ctx context.Context, arg CreateUserParams) (UserserviceUser, error) {
	row := q.db.QueryRowContext(ctx, createUser,
		arg.ID,
		arg.Username,
		arg.Email,
		arg.CreatedAt,
	)
	var i UserserviceUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.Email,
		&i.CreatedAt,
	)
	return i, err
}

const deleteChannelMember = `-- name: DeleteChannelMember :exec
DELETE FROM userservice_channel_members 
WHERE channel_id = ?1 AND user_id = ?2
`

type DeleteChannelMemberParams struct {
	ChannelID string
	UserID    string
}

func (q *Queries) DeleteChannelMember(ctx context.Context, arg DeleteChannelMemberParams) error {
	_, err := q.db.ExecContext(ctx, deleteChannelMember, arg.ChannelID, arg.UserID)
	return err
}

const getChannelByIDAndTenantID = `-- name: GetChannelByIDAndTenantID :one
SELECT id, tenant_id, name, description, is_private, created_by, created_at, updated_at FROM userservice_channels 
WHERE id = ?1 AND tenant_id = ?2
`

type GetChannelByIDAndTenantIDParams struct {
	ID       string
	TenantID string
}

func (q *Queries) GetChannelByIDAndTenantID(ctx context.Context, arg GetChannelByIDAndTenantIDParams) (UserserviceChannel, error) {
	row := q.db.QueryRowContext(ctx, getChannelByIDAndTenantID, arg.ID, arg.TenantID)
	var i UserserviceChannel
	err := row.Scan(
		&i.ID,
		&i.TenantID,
		&i.Name,
		&i.Description,
		&i.IsPrivate,
		&i.CreatedBy,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getChannelMembersByChannelIDAndTenantID = `-- name: GetChannelMembersByChannelIDAndTenantID :many
SELECT 
    cm.id as channel_member_id,
    cm.channel_id,
    cm.user_id,
    cm.role,
    cm.added_by,
    cm.created_at,
    u.username,
    u.email,
    c.name as channel_name,
    c.tenant_id
FROM userservice_channel_members cm
JOIN userservice_users u ON cm.user_id = u.id
JOIN userservice_channels c ON cm.channel_id = c.id
WHERE cm.channel_id = ?1 AND c.tenant_id = ?2
ORDER BY cm.created_at ASC
`

type GetChannelMembersByChannelIDAndTenantIDParams struct {
	ChannelID string
	TenantID  string
}

type GetChannelMembersByChannelIDAndTenantIDRow struct {
	ChannelMemberID string
	ChannelID       string
	UserID          string
	Role            string
	AddedBy         string
	CreatedAt       time.Time
	Username        string
	Email           string
	ChannelName     string
	TenantID        string
}

func (q *Queries) GetChannelMembersByChannelIDAndTenantID(ctx context.Context, arg GetChannelMembersByChannelIDAndTenantIDParams) ([]GetChannelMembersByChannelIDAndTenantIDRow, error) {
	rows, err := q.db.QueryContext(ctx, getChannelMembersByChannelIDAndTenantID, arg.ChannelID, arg.TenantID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetChannelMembersByChannelIDAndTenantIDRow
	for rows.Next() {
		var i GetChannelMembersByChannelIDAndTenantIDRow
		if err := rows.Scan(
			&i.ChannelMemberID,
			&i.ChannelID,
			&i.UserID,
			&i.Role,
			&i.AddedBy,
			&i.CreatedAt,
			&i.Username,
			&i.Email,
			&i.ChannelName,
			&i.TenantID,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getChannelsByTenantID = `-- name: GetChannelsByTenantID :many
SELECT id, tenant_id, name, description, is_private, created_by, created_at, updated_at FROM userservice_channels 
WHERE tenant_id = ?1
ORDER BY created_at DESC
`

func (q *Queries) GetChannelsByTenantID(ctx context.Context, tenantID string) ([]UserserviceChannel, error) {
	rows, err := q.db.QueryContext(ctx, getChannelsByTenantID, tenantID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []UserserviceChannel
	for rows.Next() {
		var i UserserviceChannel
		if err := rows.Scan(
			&i.ID,
			&i.TenantID,
			&i.Name,
			&i.Description,
			&i.IsPrivate,
			&i.CreatedBy,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getTenantUsers = `-- name: GetTenantUsers :many
SELECT 
    tu.role, tu.created_at,
    u.username, u.email,
    t.created_at as tenant_created_at,
    t.name as tenant_name
FROM userservice_tenant_users tu
JOIN userservice_users u ON tu.user_id = u.id
JOIN userservice_tenants t ON tu.tenant_id = t.id
WHERE tu.tenant_id = ?1
ORDER BY tu.created_at ASC
`

type GetTenantUsersRow struct {
	Role            string
	CreatedAt       time.Time
	Username        string
	Email           string
	TenantCreatedAt time.Time
	TenantName      string
}

func (q *Queries) GetTenantUsers(ctx context.Context, tenantID string) ([]GetTenantUsersRow, error) {
	rows, err := q.db.QueryContext(ctx, getTenantUsers, tenantID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetTenantUsersRow
	for rows.Next() {
		var i GetTenantUsersRow
		if err := rows.Scan(
			&i.Role,
			&i.CreatedAt,
			&i.Username,
			&i.Email,
			&i.TenantCreatedAt,
			&i.TenantName,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getUserByEmail = `-- name: GetUserByEmail :one
SELECT id, username, email, created_at FROM userservice_users 
WHERE email = ?1
`

func (q *Queries) GetUserByEmail(ctx context.Context, email string) (UserserviceUser, error) {
	row := q.db.QueryRowContext(ctx, getUserByEmail, email)
	var i UserserviceUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.Email,
		&i.CreatedAt,
	)
	return i, err
}

const getUserRoleInChannel = `-- name: GetUserRoleInChannel :one
SELECT cm.role FROM userservice_channel_members cm
JOIN userservice_channels c ON cm.channel_id = c.id
WHERE cm.channel_id = ?1 AND cm.user_id = ?2 AND c.tenant_id = ?3
`

type GetUserRoleInChannelParams struct {
	ChannelID string
	UserID    string
	TenantID  string
}

func (q *Queries) GetUserRoleInChannel(ctx context.Context, arg GetUserRoleInChannelParams) (string, error) {
	row := q.db.QueryRowContext(ctx, getUserRoleInChannel, arg.ChannelID, arg.UserID, arg.TenantID)
	var role string
	err := row.Scan(&role)
	return role, err
}

const getUserRoleInTenant = `-- name: GetUserRoleInTenant :one
SELECT role FROM userservice_tenant_users 
WHERE tenant_id = ?1 AND user_id = ?2
`

type GetUserRoleInTenantParams struct {
	TenantID string
	UserID   string
}

func (q *Queries) GetUserRoleInTenant(ctx context.Context, arg GetUserRoleInTenantParams) (string, error) {
	row := q.db.QueryRowContext(ctx, getUserRoleInTenant, arg.TenantID, arg.UserID)
	var role string
	err := row.Scan(&role)
	return role, err
}

const getUserTenants = `-- name: GetUserTenants :many
SELECT 
    tu.id as tenant_user_id,
    t.id as tenant_id, 
    t.name, 
    t.description, 
    t.is_personal, 
    t.created_at, 
    t.created_by,
    tu.role, 
    tu.created_at as joined_at
FROM userservice_tenants t
JOIN userservice_tenant_users tu ON t.id = tu.tenant_id
WHERE tu.user_id = ?1
ORDER BY t.created_at DESC
`

type GetUserTenantsRow struct {
	TenantUserID string
	TenantID     string
	Name         string
	Description  sql.NullString
	IsPersonal   bool
	CreatedAt    time.Time
	CreatedBy    string
	Role         string
	JoinedAt     time.Time
}

func (q *Queries) GetUserTenants(ctx context.Context, userID string) ([]GetUserTenantsRow, error) {
	rows, err := q.db.QueryContext(ctx, getUserTenants, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetUserTenantsRow
	for rows.Next() {
		var i GetUserTenantsRow
		if err := rows.Scan(
			&i.TenantUserID,
			&i.TenantID,
			&i.Name,
			&i.Description,
			&i.IsPersonal,
			&i.CreatedAt,
			&i.CreatedBy,
			&i.Role,
			&i.JoinedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
